# ジェンベ譜面作成アプリ

西アフリカトラディショナル譜面作成Webアプリケーション

## 概要

- **対象楽器**: ジェンベ（西アフリカの太鼓）
- **実装形式**: 静的HTML（Vanilla JavaScript）
- **動作環境**: モダンブラウザ（Chrome, Firefox, Safari, Edge）
- **デプロイ**: GitHub Pages対応

## 音の種類と記号

### 音の種類（8種類）

| 音名 | 記号 | 説明 |
|------|------|------|
| ベース | □ | 中抜き四角（通常音） |
| トーン | ○ | 中抜き丸（通常音） |
| スラップ | △ | 中抜き三角（通常音） |
| ベース（ミュート） | ■ | 塗りつぶし四角（ミュート音） |
| トーン（ミュート） | ● | 塗りつぶし丸（ミュート音） |
| スラップ（ミュート） | ▲ | 塗りつぶし三角（ミュート音） |
| ロール | ≡ | 三本線 |
| フラム | ≈ | 波線（装飾記号） |

**記号の使い方:**
- 基本音6種類（□○△■●▲）とロール（≡）は単独で配置
- フラム（≈）はフラムボタンをONにすることで基本音と組み合わせて使用（例: □≈, ●≈）
- フラムとロール（≡）は組み合わせできません
- 1マスに1つの記号または組み合わせを配置

## 譜面構造

### 基本構成

- **1行 = 2小節**
- **各小節は独立して4連/3連を設定可能**
- **小節の区切りは太い縦線で表示**

### グリッド例

```
4連 + 4連の場合（8マス）:
[小節1: □ □ □ □] [小節2: ○ ○ ○ ○]

4連 + 3連の場合（7マス）:
[小節1: □ □ □ □] [小節2: ○ ○ ○]

3連 + 3連の場合（6マス）:
[小節1: □ □ □] [小節2: ○ ○ ○]
```

## 主要機能

### 譜面名称

- パート追加ボタンの下に「譜面名称」入力欄があります
- 保存時のファイル名に使用されます
- 例: 「アフリカンリズム練習曲」→ `アフリカンリズム練習曲.json`

### パート管理

- **最大4パート**まで追加可能
- パート名はクリックして編集可能
- 各パートは独立した譜面を持ちます
- パートごとに行数を自由に追加可能

### 記号配置

1. **音の種類**パレットから記号を選択（紫枠で強調表示）
2. フラムボタンで装飾ON/OFF切り替え
3. グリッドをクリックして配置
4. **同じ記号で再クリックすると削除**（空欄にできます）
5. 異なる記号をクリックすると上書き

### 小節設定

- 各行の右側に小節ごとの「4連/3連」切り替えボタンがあります
- 4連ボタン: 紫色
- 3連ボタン: 緑色
- クリックで即座に切り替わり、グリッドが自動調整されます

### 行操作

- **コピー**: 行の小節構成と記号配置をコピー
- **貼付**: 他の行にコピー内容を貼り付け
- **+ 行を追加**: 新しい行を追加（デフォルト: 4連+4連）

### 小節ハイライト

- グリッドをクリックすると、その小節全体が黄色でハイライト表示されます
- 現在の操作対象が視覚的に明確になります

## データ保存

### LocalStorage（自動保存）

- 記号配置、パート構成、小節設定、譜面名称を自動保存
- ブラウザを閉じても同じブラウザでデータが保持されます

### JSONファイル保存

**保存:**
- 「保存」ボタンをクリック
- 譜面名が設定されている場合: `譜面名.json`
- 譜面名が空の場合: `djembe-score-タイムスタンプ.json`

**読込:**
- 「読込」ボタンをクリック
- JSONファイルを選択して読み込み

**JSONフォーマット:**
```json
{
  "scoreName": "アフリカンリズム練習曲",
  "parts": [
    {
      "name": "パート1",
      "rowConfigs": [
        { "beats": [4, 4] },
        { "beats": [4, 3] }
      ],
      "notes": {
        "0": "□",
        "4": "○≈"
      }
    }
  ]
}
```

## レスポンシブデザイン

### スマートフォン対応

- 各要素のサイズが画面幅に応じて自動調整
- 記号パレットとグリッドは横スクロール対応
- タッチ操作に最適化
- 主にスマートフォンでの使用を想定した設計

### 画面サイズ別調整

- **768px以下**: タブレット・スマートフォン向けレイアウト
- **480px以下**: 小型スマートフォン向けレイアウト

## 操作方法

1. **記号選択** → グリッドに配置
2. **フラム（≈）** でフラム装飾ON/OFF
   - ONの時: 基本音+フラム（例: □≈）
3. **パート名**クリックで編集
4. **小節クリック**で黄色ハイライト
5. **4連/3連ボタン**で小節切替
6. **コピー/貼付**で行を複製

## 技術仕様

### データ構造

```javascript
{
  scoreName: string,           // 譜面名称
  parts: [
    {
      id: number,              // パートID（内部管理用）
      name: string,            // パート名
      rowConfigs: [
        { beats: [4, 4] }      // [小節1の連数, 小節2の連数]
      ],
      notes: {
        "0": "□",              // position: 記号
        "4": "○≈"              // フラム付き記号
      }
    }
  ]
}
```

### Position計算（累積方式）

- 前の行までのマス数を加算して位置を計算
- 例:
  - 1行目: 8マス（4+4）
  - 2行目: 7マス（4+3）
  - 2行目の最初のセル = position 8
  - 2行目の5番目のセル = position 12

### 使用技術

- **HTML5/CSS3**: レイアウトとスタイリング
- **Vanilla JavaScript**: ロジック実装
- **LocalStorage API**: 自動保存
- **Unicode記号**: □○△■●▲≡≈

## ライセンス

MIT License
